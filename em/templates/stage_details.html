{% extends 'base.html' %}

{% block body_block %}

<div>
    <div class="row">
        <h1 class="mx-auto">{{ stage.name }}</h1>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <span class="text-success">начало</span><h5 class="text-primary">{{ stage.date_start }}</h5>
        </div>
        <div class="col-sm-12">
            <span class="text-danger">конец</span><h5 class="text-primary">{{ stage.date_end }}</h5>
        </div>
    </div>
    <div class="row bg-light py-2">
        <h5 class="mx-auto">Информания</h5>
        <div class="col-sm-12 text-justify">{{ stage.info }}</div>
    </div>


</div>


<div>
    <div class="row my-2 px-2 border-top">
        <h6 class="mt-3">Гонки этапа:</h6>
    </div>
    {% if races %}
    <a class="w-100 btn btn-success" role="button" href="{% url 'em:race_add' stage.id %}">
        <i class="fas fa-plus-square"></i> Добавиь гонку
    </a>
    {% for race in races %}
     <div class="row border border-info my-2 p-2">
        <div class="col-sm-12">
            <a class="w-100 btn btn-warning mt-1 mb-3" href="{% url 'em:race_details' race.id stage.id %}">
                <h3>{{ race.name }}</h3>
            </a>
        </div>

        <div class="col-sm-12">
            <div class="col-sm-6 mx-auto">
                <button class="w-100 button btn-dark" onclick="$('#kick-{{ race.id }}').toggle();">
                    Удалить гонку?
                </button>
            </div>
            <div class="col-sm-6 mx-auto mt-3" id="kick-{{ race.id }}" style="display: none">
                <a class="button btn-secondary text-white px-3 py-2" href="{% url 'em:race_delete' race.id stage.id %}">
                    подтвердить
                </a>
            </div>
        </div>
    </div>
    {% endfor %}
    {% else %}
    <div class="row bg-light border border-info bg-light my-2 p-2">
        <div class="col-sm-12">
            <a class="w-100 mx-auto text-uppercase" role="button" href="{% url 'em:race_add' stage.id %}">
                <i class="fas fa-info-circle"></i>
                нужно добавить гонки
            </a>
        </div>
    </div>
    {% endif %}
</div>

<div>
    <div class="row my-2 px-2 border-top">
        <h6 class="mt-3">Райдеры этапа:</h6>
    </div>
    {% if riders %}
    <a class="w-100 btn btn-success" role="button" href="{% url 'em:riders' %}">
        <i class="fas fa-plus-square"></i> Добавиь райдера
    </a>
    {% for rider in riders %}
     <div class="row border border-info my-2 p-2">
        <div class="col-sm-12">
            <a class="w-100 btn btn-secondary mt-1 mb-3" href="{% url 'em:rider_details' rider.id %}">
                <h3>{{ rider.name }}</h3>
            </a>
        </div>

        <div class="col-sm-12">
            <div class="col-sm-6 mx-auto">
                <button class="w-100 button btn-dark" onclick="$('#kick-{{ rider.id }}').toggle();">
                    Убрать райдера из этапа?
                </button>
            </div>
            <div class="col-sm-6 mx-auto mt-3" id="kick-{{ rider.id }}" style="display: none">
                <a class="button btn-secondary text-white px-3 py-2" href="{% url 'em:rider_stage_unassign' rider.id stage.id %}">
                    подтвердить
                </a>
            </div>
        </div>
    </div>
    {% endfor %}
    {% else %}
    <div class="row bg-light border border-info bg-light my-2 p-2">
        <div class="col-sm-12">
            <a class="w-100 mx-auto text-uppercase" role="button" href="{% url 'em:riders' %}">
                <i class="fas fa-info-circle"></i>
                нужно добавить участников
            </a>
        </div>
    </div>
    {% endif %}
</div>

<div class="row mt-3">
    <div class="col-sm-6 mx-auto">
        <button class="w-100 button btn-danger" onclick="$('#delete-stageId-{{ stage.id }}').toggle();">
            Удалить этап?
        </button>
    </div>
    <div class="col-sm-6 mx-auto mt-3" id="delete-stageId-{{ stage.id }}" style="display: none">
        <a class="button btn-secondary text-white px-3 py-2" href="{% url 'em:stage_delete' stage.id %}">
            подтвердить
        </a>
    </div>
</div>

{% endblock %}